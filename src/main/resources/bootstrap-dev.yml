spring:
  application:
    name: alloy-gateway
  cloud:
    nacos:
      discovery:
        server-addr: 120.79.94.56:8848
        group: ALLOY
        namespace: 50e447c9-4212-43f1-92c2-a76edcb195d7
      config:
        group: ${spring.cloud.nacos.discovery.group}
        namespace: ${spring.cloud.nacos.discovery.namespace}
        server-addr: ${spring.cloud.nacos.discovery.server-addr}
        file-extension: yml
        shared-configs:
          - ${spring.application.name}-${spring.profiles.active}.${spring.cloud.nacos.config.file-extension}
      username: nacos
      password: nacos

    gateway:
      discovery:
        locator:
          enabled: true
      globalcors:
        cors-configurations:
          '[/**]':
            # 允许携带认证信息
            # 允许跨域的源(网站域名/ip)，设置*为全部
            # 允许跨域请求里的head字段，设置*为全部
            # 允许跨域的method， 默认为GET和OPTIONS，设置*为全部
            # 跨域允许的有效期
            allow-credentials: true
            allowed-origins: "*"
#              - "http://alloy-auth:9998"
#              - "http://alloy-ucenter:9997"
            allowed-headers: "*"
            allowed-methods: "*"
            max-age: 3600
            # 允许response的head信息
            # 默认仅允许如下6个：
            #     Cache-Control
            #     Content-Language
            #     Content-Type
            #     Expires
            #     Last-Modified
            #     Pragma
            #exposed-headers:
      routes:
        # 认证中心
        - id: alloy-auth
          uri: lb://alloy-auth
          predicates:
            - Path=/auth/**
          filters:
            # 验证码处理
#            - ValidateCodeGatewayFilter
            # 前端密码解密
            - PasswordDecoderFilter
        #UPMS 模块
        - id: alloy-ucenter
          uri: lb://alloy-ucenter
          predicates:
            - Path=/ucenter/**
          filters:
            # 限流配置
            - name: RequestRateLimiter
              args:
                key-resolver: '#{@remoteAddrKeyResolver}'
                redis-rate-limiter.replenishRate: 100
                redis-rate-limiter.burstCapacity: 200
  redis:
    host: 120.79.94.56
    port: 6379
security:
  encode:
    # 密码密钥，必须16位
    key: 'do***.plat4cloud'


